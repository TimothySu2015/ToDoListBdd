# Sprint Change Proposal - ToDoListBDD BDD 驅動架構

## 變更摘要

**日期**: 2025-08-21  
**變更類型**: 架構需求澄清與技術棧完整化  
**影響範圍**: PRD、架構設計、開發流程

## 識別問題

**核心問題**: PRD 文件與實際技術需求不一致
- **PRD 聲明**: 純前端應用，無需後端服務
- **實際需求**: BDD 驅動的全端開發流程，使用 Angular 19 + .NET 9 (CQRS + MediatR) + SQLite

**觸發因素**: 架構師在開始架構設計時發現需求衝突

## Epic 影響分析

### 原始 Epic 結構 (基於錯誤假設)
1. Epic 1: 基礎設定與核心任務管理 (純前端)
2. Epic 2: 使用者體驗優化與進階功能 (純前端)

### 修正後 Epic 結構 (BDD 驅動)
1. **Epic 1: BDD 需求分析與測試基礎建立**
2. **Epic 2: 後端 CQRS API 實作與資料層** 
3. **Epic 3: 前端 Angular 開發與 API 整合**
4. **Epic 4: BDD 整合測試與系統優化**

**Epic 影響**: 從 2 個前端 Epic 重構為 4 個 BDD 驅動的全端 Epic

## 文件修改清單

### 1. PRD 文件更新 ✅
**檔案**: `docs/prd-final.md`

**主要變更**:
- 目標重新定義為 BDD 驅動開發示範
- 完整技術棧規格 (Angular 19 + .NET 9 + MediatR + SQLite)
- Epic 結構重新設計
- 加入 BDD 開發流程說明

### 2. 新增 BDD 規格文件 ✅
**檔案**: `docs/bdd-specifications.md`

**內容**:
- 完整的 Gherkin BDD 場景
- API 契約定義 (基於 BDD 場景)
- CQRS Commands/Queries 映射
- 資料模型定義
- 測試實作策略

### 3. 前端規格調整
**檔案**: `docs/front-end-spec-simplified.md`

**需要調整**:
- API 整合策略取代 localStorage
- 錯誤處理和載入狀態管理
- 網路狀態指示

### 4. 架構文件指向
**檔案**: `docs/architecture.md`

**需要創建**: 全端架構文件 (由架構師 Winston 處理)
- Angular 19 + .NET 9 整合設計
- MediatR CQRS 架構模式
- SQLite 資料層設計
- BDD 測試整合策略

## 推薦路徑

### 選擇的解決方案: BDD 中心化開發流程

**理由**:
1. **保持功能簡化**: ToDoList 功能範圍不變
2. **展示企業級實踐**: BDD + CQRS + 全端架構
3. **可復用流程**: 建立可重複使用的開發模板
4. **真正的敏捷**: BDD 文件作為唯一需求來源

### 技術棧確認

| Category | Technology | Version | Purpose |
|----------|------------|---------|---------|
| Frontend | Angular | 19.x | SPA 前端應用 |
| Backend | .NET | 9.x | Web API 服務 |
| CQRS | MediatR | 12.x | 命令查詢分離 |
| Database | SQLite | 3.x | 輕量級資料儲存 |
| ORM | Entity Framework Core | 9.x | 資料存取層 |
| BDD Testing | SpecFlow + Cucumber | Latest | 行為驅動測試 |

## MVP 影響

**功能範圍**: 保持不變 (簡化的個人待辦清單)
**技術複雜度**: 顯著增加 (但符合原始意圖)
**開發時程**: 適度延長 (加入後端開發)
**學習價值**: 大幅提升 (完整的現代開發流程)

## 行動計劃

### 立即執行 ✅
1. ✅ 更新 PRD 反映完整技術棧
2. ✅ 建立 BDD 規格文件
3. ✅ 建立此變更提案文件

### 後續步驟
1. **架構師 (Winston)**: 基於新 PRD 設計全端架構
2. **前端規格調整**: 加入 API 整合策略
3. **開始 Epic 1**: BDD 場景詳細撰寫

## 代理人交接計劃

### 架構師 (Winston)
- **輸入**: 更新的 PRD + BDD 規格文件
- **任務**: 設計 Angular 19 + .NET 9 + MediatR CQRS + SQLite 全端架構
- **重點**: BDD 測試整合、API 設計、資料流程

### UX 專家 (Sally)
- **任務**: 調整前端規格加入 API 整合考量
- **重點**: 載入狀態、錯誤處理、網路狀態 UI

### 開發團隊
- **準備**: 等待架構完成後開始 Epic 1 (BDD 場景撰寫)

## 成功指標

1. **BDD 文件驅動**: 所有開發決策基於 BDD 場景
2. **技術展示**: 完整的現代全端開發流程
3. **功能簡化**: 保持 ToDoList 的簡潔性
4. **可復用性**: 建立可重複使用的開發模板

## 風險評估與緩解

### 識別風險
1. **複雜度增加**: 從純前端到全端開發
2. **學習曲線**: MediatR CQRS 對團隊可能較新
3. **時程延長**: 加入後端開發工作

### 緩解策略
1. **漸進開發**: Epic 分階段執行，降低風險
2. **文件完備**: 詳細的 BDD 和架構文件
3. **原型驗證**: 先建立基本功能原型驗證架構

## 結論

這個變更將 ToDoListBDD 從一個簡單的前端專案轉換為一個**展示現代 BDD 驅動全端開發流程的完整範例**，同時保持功能的簡化特性。

**關鍵價值**:
- 展示企業級開發實踐
- BDD 文件作為唯一需求來源
- 可復用的開發流程模板
- 完整的技術棧整合

**下一步**: 架構師 Winston 基於更新的需求開始全端架構設計

---

**批准狀態**: ✅ 已批准  
**執行狀態**: ✅ 文件更新已完成  
**責任人**: PM John  
**日期**: 2025-08-21